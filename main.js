(()=>{"use strict";function e(e,t){t&&("string"==typeof t?e.classList.add(t):e.classList.add(...t))}class t{dropdowns=[];htmlBar;constructor(e){this.htmlBar=e,e.querySelectorAll(".dropdown-anchor").forEach((e=>{this.dropdowns.push(new s(e))})),this.attachMouseEnterListeners()}attachMouseEnterListeners(){this.dropdowns.forEach((e=>{this.attachMouseEnterListener(e)}))}attachMouseEnterListener(e){e.getAnchor().htmlElem.addEventListener("mouseenter",(()=>{this.switchOpenedDropdowns(e)}))}switchOpenedDropdowns(e){const t=e.getAnchor();t.isEnabled()&&this.closeOpenedDropdowns([e])&&(t.openDropdown(),t.htmlElem.classList.add("highlighted"))}closeOpenedDropdowns(e){let t=0;return this.dropdowns.forEach((s=>{!e.includes(s)&&s.getAnchor().htmlElem.classList.contains("opened")&&(t++,s.closeHierarchy())})),t}}class s{origins=[];hoverDelay;htmlAnchor;constructor(e){this.htmlAnchor=e,this.hoverDelay=e.getAttribute("hoverdelay")||500,this.origins.push(new i(e,this.hoverDelay));const t=e.querySelectorAll(".dropdown-expand");for(const e of t)this.origins.push(new i(e,this.hoverDelay));this.attachMouseEnterListener(),this.attachClickListener(),this.attachResizeListener(),this.attachCloseOnSelectListeners()}getAnchor(){return this.origins[0]}closeHierarchy(){this.origins.forEach((e=>{e.htmlElem.classList.remove("highlighted"),e.htmlElem.classList.remove("opened")}))}closeDeeperThanMouse(e,t,s){const i=document.elementsFromPoint(e,t);let n;for(const e of i)if(e.classList.contains("dropdown")){n=e;break}if(!n)return;const o=n.querySelectorAll(".dropdown-expand, .dropdown-anchor");for(const e of o)s?e.classList.contains("highlighted")||e.classList.remove("opened"):(e.classList.remove("highlighted"),e.menuCloseTimeout=setTimeout((()=>{e.classList.contains("highlighted")||e.classList.remove("opened")}),this.hoverDelay))}closeOnClickOutsideHierarchy(e){var t,s;this.htmlAnchor.classList.contains("opened")&&(t=this.htmlAnchor)!==(s=e)&&!function(e,t){const s=e.querySelectorAll("*");for(const e of s)if(e===t)return!0;return!1}(t,s)&&this.closeHierarchy()}repositionOffscreenDropdowns(){if(this.getAnchor().htmlElem.classList.contains("opened")){this.getAnchor().repositionOffscreenMenu();for(let e=1;e<this.origins.length;e++)this.origins[e].htmlElem.classList.contains("opened")&&this.origins[e].repositionOffscreenMenu()}}attachMouseEnterListener(){this.htmlAnchor.addEventListener("mouseenter",(e=>{this.closeDeeperThanMouse(e.clientX,e.clientY,!1)}))}attachClickListener(){document.addEventListener("mousedown",(e=>{this.closeOnClickOutsideHierarchy(e.target),this.closeDeeperThanMouse(e.clientX,e.clientY,!0)}))}attachResizeListener(){window.addEventListener("resize",this.repositionOffscreenDropdowns.bind(this))}attachCloseOnSelectListeners(){const e=this.htmlAnchor.querySelectorAll(".dropdown > div > div:first-of-type");for(const t of e)"true"===t.getAttribute("closeonselect")&&"false"!==t.getAttribute("enabled")&&t.addEventListener("mousedown",(e=>{0===e.button&&this.closeHierarchy()}))}}class i{enterTime;htmlElem;menuElem;itemElem;menuItemOuterDivs;menuItemContentDivs=[];menuOpenTimeout;menuCloseTimeout;hoverDelay;popDirection;appearAnimRunning=!1;isAnchor;static positionOffsetValues={negativeAnchorHorizBorderOffset:"calc(var(--dropdown-anchor-border-width-horiz) * -1)",negativeAnchorVertBorderOffset:"calc(var(--dropdown-anchor-border-width-vert) * -1)",negativeBorderOffset:"calc(var(--dropdown-border-width) * -1)",fullOffset:"100%"};static invertedDirections={top:"bottom",bottom:"top",right:"left",left:"right"};constructor(e,t){let s;this.htmlElem=e,this.menuElem=e.querySelector(".dropdown"),this.menuItemOuterDivs=this.getAllMenuItemsAtThisDropdownLevel(),this.isAnchor=this.htmlElem.classList.contains("dropdown-anchor"),this.isAnchor?(s=e.getAttribute("popdirection")||"bottom-right",this.itemElem=e.querySelector(".dropdown-anchor > div:first-of-type")):(s=e.getAttribute("popdirection")||"right-bottom",this.appendSubmenuArrow(),this.itemElem=e.querySelector(".dropdown > div > div:first-of-type")),this.popDirection=s.split("-"),this.hoverDelay=t||500;let i=e.getAttribute("onset");i||(i=this.isAnchor?"false":"true"),this.attachMouseEnterListener("true"===i),this.attachClickListener(),this.attachMouseLeaveListeners(),this.attachAnimListeners()}getAllMenuItemsAtThisDropdownLevel(){const e=[this.menuElem.querySelector(".dropdown > div")];let t=e[0].nextSibling;for(;t;)1!==t.nodeType||t.classList.contains("dropdown-spacer")||e.push(t),t=t.nextSibling;return e}appendSubmenuArrow(){const t=this.htmlElem.querySelector(".dropdown");if(!t)return;const s=function(t,s,i,n){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("viewBox","0 0 24 24");const r=document.createElementNS("http://www.w3.org/2000/svg","title");r.textContent=void 0,o.appendChild(r);const l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("d","M10,17L15,12L10,7V17Z"),o.appendChild(l),e(o,void 0),e(l,void 0),o}();s.classList.add("dropdown-expand-img"),this.htmlElem.insertBefore(s,t)}setMenuToDefaultPosition(){let e;e=this.isAnchor?"right"===this.popDirection[1]||"left"===this.popDirection[1]?i.positionOffsetValues.negativeAnchorHorizBorderOffset:i.positionOffsetValues.negativeAnchorVertBorderOffset:i.positionOffsetValues.negativeBorderOffset;const t=[i.invertedDirections[this.popDirection[0]],i.invertedDirections[this.popDirection[1]]];this.menuElem.style[this.popDirection[0]]="",this.menuElem.style[t[0]]=i.positionOffsetValues.fullOffset,this.menuElem.style[this.popDirection[1]]="",this.menuElem.style[t[1]]=e,this.menuElem.style["transform-origin"]=`${t[0]} ${t[1]}`}repositionOffscreenMenu(){this.setMenuToDefaultPosition();const e=document.documentElement.clientWidth||window.innerWidth,t=document.documentElement.clientHeight||window.innerHeight,s=this.menuElem.getBoundingClientRect(),i=window.getComputedStyle(this.menuElem).getPropertyValue("left"),n=Number(i.replace("px","")),o=window.getComputedStyle(this.menuElem).getPropertyValue("top"),r=Number(o.replace("px",""));s.left<=5?this.menuElem.style.left=n-s.left+5+"px":s.right>=e-5&&(this.menuElem.style.left=n-(s.right-e+5)+"px"),s.top<=5?this.menuElem.style.top=r-s.top+5+"px":s.bottom>=t-5&&(this.menuElem.style.top=r-(s.bottom-t+5)+"px")}isEnabled(){return"false"!==this.itemElem.getAttribute("enabled")}openDropdown(){this.htmlElem.classList.add("opened"),this.repositionOffscreenMenu(),this.menuItemContentDivs.forEach((e=>{e.classList.remove("mouseover")})),this.itemElem.classList.add("mouseover")}scheduleOpenMenu(){this.isEnabled()&&(this.htmlElem.classList.add("highlighted"),this.menuOpenTimeout=setTimeout((()=>{this.htmlElem.classList.contains("opened")||(this.openDropdown(),clearTimeout(this.menuCloseTimeout))}),this.hoverDelay))}scheduleCloseMenu(e,t){this.isEnabled()&&(clearTimeout(this.menuOpenTimeout),function(e,t){for(const t of e)if(t.classList.contains("dropdown"))return!0;return!1}(document.elementsFromPoint(e,t))&&(this.htmlElem.classList.remove("highlighted"),this.menuCloseTimeout=setTimeout((()=>{this.htmlElem.classList.contains("highlighted")||this.htmlElem.classList.remove("opened")}),this.hoverDelay)))}toggleOpenMenu(e,t){this.isEnabled()&&(function(e,t){for(const s of e)if(s===t)return!0;return!1}(document.elementsFromPoint(e,t),this.htmlElem)&&(this.htmlElem.classList.contains("opened")?(this.htmlElem.classList.remove("opened"),this.isAnchor&&this.htmlElem.classList.remove("highlighted"),clearTimeout(this.menuOpenTimeout)):(this.htmlElem.classList.add("highlighted"),this.openDropdown())),clearTimeout(this.menuCloseTimeout))}addMouseoverClass(e){"false"!==e.getAttribute("enabled")&&e.classList.add("mouseover")}attachMouseEnterListener(e){this.htmlElem.addEventListener("mouseenter",(()=>{e&&this.scheduleOpenMenu()}))}attachClickListener(){this.htmlElem.addEventListener("mousedown",(e=>{0===e.button&&this.toggleOpenMenu(e.clientX,e.clientY)}))}attachMouseLeaveListeners(){this.htmlElem.addEventListener("mouseleave",(e=>{this.scheduleCloseMenu(e.clientX,e.clientY),"click"===this.htmlElem.getAttribute("onset")||this.htmlElem.classList.contains("opened")||this.htmlElem.classList.remove("highlighted")}));for(const e of this.menuItemOuterDivs){const t=e.querySelector(".dropdown > div > div:first-of-type");this.menuItemContentDivs.push(t),e.addEventListener("mouseleave",(()=>{this.addMouseoverClass(t)}))}}attachAnimListeners(){this.menuElem.addEventListener("animationend",(e=>{"dropdown-appear"===e.animationName&&(this.appearAnimRunning=!1,this.repositionOffscreenMenu())})),this.menuElem.addEventListener("animationcancel",(e=>{"dropdown-appear"===e.animationName&&(this.appearAnimRunning=!1)})),this.menuElem.addEventListener("animationstart",(e=>{"dropdown-appear"===e.animationName&&(this.appearAnimRunning=!0,this.updateMenuAnimPosition())}))}updateMenuAnimPosition(){setTimeout((()=>{this.repositionOffscreenMenu(),this.appearAnimRunning&&this.updateMenuAnimPosition()}),1)}}!function(){const e=document.querySelectorAll(".dropdown-bar"),i=document.querySelectorAll("*:not(.dropdown-bar) > div.dropdown-anchor, *:not(.dropdown-bar) > button.dropdown-anchor"),n=[],o=[];e.forEach((e=>{n.push(new t(e))})),i.forEach((e=>{o.push(new s(e))}))}();const n=document.querySelectorAll(".dropdown > div > div:first-of-type");const o=document.querySelector(".log-text");n.forEach((e=>{e.addEventListener("mousedown",(t=>{0===t.button&&"false"!==e.getAttribute("enabled")&&(console.log(`Clicked ${e.getAttribute("id")}`),o.textContent=`Clicked ${e.getAttribute("id")}`)}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtzRSxTQUFTNUQsaUJBQWlCLG1CQUFvQmtELElBQ3BCLG9CQUF6QkEsRUFBTzRGLGdCQUNUeEosS0FBSzRFLG1CQUFvQixFQUMzQixJQUdGNUUsS0FBS3NFLFNBQVM1RCxpQkFBaUIsa0JBQW1Ca0QsSUFDbkIsb0JBQXpCQSxFQUFPNEYsZ0JBQ1R4SixLQUFLNEUsbUJBQW9CLEVBQ3pCNUUsS0FBS3lKLHlCQUNQLEdBRUosQ0FHQSxzQkFBQUEsR0FDRXpHLFlBQVcsS0FDVGhELEtBQUt5RCwwQkFFRHpELEtBQUs0RSxtQkFDUDVFLEtBQUt5Six3QkFDUCxHQUNDLEVBQ0wsR0FLSyxXQUNMLE1BQU1DLEVBQWVqSCxTQUFTeEMsaUJBQWlCLGlCQUN6QzBKLEVBQWtCbEgsU0FBU3hDLGlCQUMvQiw2RkFHSTJKLEVBQU8sR0FDUEMsRUFBVSxHQUVoQkgsRUFBYXhKLFNBQVM0SixJQUNwQkYsRUFBS3pKLEtBQUssSUFBSVIsRUFBWW1LLEdBQU0sSUFHbENILEVBQWdCekosU0FBUzZKLElBQ3ZCRixFQUFRMUosS0FBSyxJQUFJQyxFQUFTMkosR0FBUyxHQU92QyxDQ2xoQkEsR0FFQSxNQUFNQyxFRG9oQkt2SCxTQUFTeEMsaUJBQWlCLHVDQ25oQnJDLE1BQU1nSyxFQUFjeEgsU0FBU2lELGNBQWMsYUFFM0NzRSxFQUFVOUosU0FBU2dLLElBQ2pCQSxFQUFNeEosaUJBQWlCLGFBQWNrRCxJQUNiLElBQWxCQSxFQUFPUSxRQUFrRCxVQUFsQzhGLEVBQU12SSxhQUFhLGFBQzVDd0ksUUFBUUMsSUFBSSxXQUFXRixFQUFNdkksYUFBYSxTQUMxQ3NJLEVBQVlwRCxZQUFjLFdBQVdxRCxFQUFNdkksYUFBYSxRQUMxRCxHQUNBLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vcy1saWtlLWRyb3Bkb3duLy4vc3JjL2RvbS11dGlsaXRpZXMuanMiLCJ3ZWJwYWNrOi8vb3MtbGlrZS1kcm9wZG93bi8uL3NyYy9vcy1saWtlLWRyb3Bkb3duLmpzIiwid2VicGFjazovL29zLWxpa2UtZHJvcGRvd24vLi9zcmMvc2NyaXB0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBmcmVlemUoX2h0bWxFbGVtLCBfZXhjbHVkZVNlbGVjdG9yKSB7XG4gIF9odG1sRWxlbS5jbGFzc0xpc3QuYWRkKFwiZnJlZXplXCIpO1xuICBjb25zdCBmb2N1c2FibGUgPSBfaHRtbEVsZW0ucXVlcnlTZWxlY3RvckFsbChcbiAgICBgW3RhYmluZGV4PVwiMFwiXSR7X2V4Y2x1ZGVTZWxlY3Rvcn1gXG4gICk7XG4gIGZvciAoY29uc3QgZWxlbSBvZiBmb2N1c2FibGUpIHtcbiAgICBlbGVtLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRoYXcoX2h0bWxFbGVtLCBfZXhjbHVkZVNlbGVjdG9yKSB7XG4gIF9odG1sRWxlbS5jbGFzc0xpc3QucmVtb3ZlKFwiZnJlZXplXCIpO1xuICBjb25zdCBmb2N1c2FibGUgPSBfaHRtbEVsZW0ucXVlcnlTZWxlY3RvckFsbChcbiAgICBgW3RhYmluZGV4PVwiLTFcIl0ke19leGNsdWRlU2VsZWN0b3J9YFxuICApO1xuICBmb3IgKGNvbnN0IGVsZW0gb2YgZm9jdXNhYmxlKSB7XG4gICAgZWxlbS5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCBcIjBcIik7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFwcGVuZChfZWxlbVR5cGUsIF9jbGFzc2VzLCBfcGFyZW50RWxlbSwgX3RleHRDb250ZW50KSB7XG4gIC8vIElmIF9lbGVtVHlwZSBpcyBhIHN0cmluZywgY3JlYXRlIGl0OyBvdGhlcndpc2UgYXNzdW1lIGl0J3MgYW4gZXhpc3RpbmdcbiAgLy8gZWxlbWVudCBhbmQgdXNlIGl0IGFzIHBhc3NlZC5cbiAgbGV0IGVsZW07XG4gIGlmICh0eXBlb2YgX2VsZW1UeXBlID09IFwic3RyaW5nXCIpIHtcbiAgICBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChfZWxlbVR5cGUpO1xuICB9IGVsc2Uge1xuICAgIGVsZW0gPSBfZWxlbVR5cGU7XG4gIH1cblxuICBhZGRDbGFzc2VzKGVsZW0sIF9jbGFzc2VzKTtcblxuICBpZiAoX3RleHRDb250ZW50KSB7XG4gICAgZWxlbS50ZXh0Q29udGVudCA9IF90ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9wYXJlbnRFbGVtLmFwcGVuZENoaWxkKGVsZW0pO1xuXG4gIHJldHVybiBlbGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmFkaW9WYWx1ZShfZmllbGRzZXQpIHtcbiAgY29uc3QgcmFkaW9zID0gX2ZpZWxkc2V0LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHJhZGlvcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChyYWRpb3NbaV0uY2hlY2tlZCkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIC0xO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0SW5wdXRBdHRyaWJ1dGVzKF9lbGVtLCBfdHlwZSwgX25hbWVJZCwgX3ZhbHVlKSB7XG4gIGlmIChfdHlwZSkgX2VsZW0uc2V0QXR0cmlidXRlKFwidHlwZVwiLCBfdHlwZSk7XG5cbiAgaWYgKF9uYW1lSWQpIHtcbiAgICBfZWxlbS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIF9uYW1lSWQpO1xuICAgIF9lbGVtLnNldEF0dHJpYnV0ZShcImlkXCIsIF9uYW1lSWQpO1xuICB9XG5cbiAgaWYgKF92YWx1ZSkgX2VsZW0uc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgX3ZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJhZGlvRmllbGQoX25hbWUsIF9kZWZhdWx0VmFsdWUsIF9sYWJlbEFycikge1xuICBjb25zdCBmaWVsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcbiAgZmllbGQuY2xhc3NMaXN0LmFkZChgJHtfbmFtZX0tZmllbGRzZXRgKTtcblxuICBjb25zdCByYWRpb3MgPSBbXTtcbiAgY29uc3QgbGFiZWxzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBfbGFiZWxBcnIubGVuZ3RoOyBpKyspIHtcbiAgICByYWRpb3MucHVzaChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIikpO1xuICAgIHJhZGlvc1tpXS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwicmFkaW9cIik7XG4gICAgcmFkaW9zW2ldLnNldEF0dHJpYnV0ZShcImlkXCIsIGAke19uYW1lfS0ke2l9YCk7XG4gICAgcmFkaW9zW2ldLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgX25hbWUpO1xuICAgIHJhZGlvc1tpXS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBfbGFiZWxBcnJbaV0pO1xuICAgIGZpZWxkLmFwcGVuZENoaWxkKHJhZGlvc1tpXSk7XG5cbiAgICBsYWJlbHMucHVzaChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIikpO1xuICAgIGxhYmVsc1tpXS5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgYCR7X25hbWV9LSR7aX1gKTtcbiAgICBsYWJlbHNbaV0udGV4dENvbnRlbnQgPSBfbGFiZWxBcnJbaV07XG4gICAgZmllbGQuYXBwZW5kQ2hpbGQobGFiZWxzW2ldKTtcbiAgfVxuXG4gIHJhZGlvc1tfZGVmYXVsdFZhbHVlXS5zZXRBdHRyaWJ1dGUoXCJjaGVja2VkXCIsIFwiXCIpO1xuXG4gIHJldHVybiBmaWVsZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN2ZyhfcGF0aCwgX3RpdGxlLCBfY2xhc3NlcywgX3BhdGhDbGFzc2VzKSB7XG4gIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwic3ZnXCIpO1xuICBzdmcuc2V0QXR0cmlidXRlKFwidmlld0JveFwiLCBcIjAgMCAyNCAyNFwiKTtcblxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwidGl0bGVcIik7XG4gIHRpdGxlLnRleHRDb250ZW50ID0gX3RpdGxlO1xuICBzdmcuYXBwZW5kQ2hpbGQodGl0bGUpO1xuICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJwYXRoXCIpO1xuICBwYXRoLnNldEF0dHJpYnV0ZShcImRcIiwgX3BhdGgpO1xuICBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7XG5cbiAgYWRkQ2xhc3NlcyhzdmcsIF9jbGFzc2VzKTtcbiAgYWRkQ2xhc3NlcyhwYXRoLCBfcGF0aENsYXNzZXMpO1xuXG4gIHJldHVybiBzdmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRDbGFzc2VzKF9lbGVtLCBfY2xhc3Nlcykge1xuICBpZiAoX2NsYXNzZXMpIHtcbiAgICAvLyBDYW4gcGFzcyBhcnJheSBvZiBzdHJpbmdzIG9yIHNpbmdsZSBzdHJpbmcuXG4gICAgaWYgKHR5cGVvZiBfY2xhc3NlcyA9PSBcInN0cmluZ1wiKSB7XG4gICAgICBfZWxlbS5jbGFzc0xpc3QuYWRkKF9jbGFzc2VzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgX2VsZW0uY2xhc3NMaXN0LmFkZCguLi5fY2xhc3Nlcyk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub2RlTGlzdENvbnRhaW5zQ2xhc3MoX25vZGVMaXN0LCBfY2xhc3MpIHtcbiAgZm9yIChjb25zdCBlbGVtIG9mIF9ub2RlTGlzdCkge1xuICAgIGlmIChlbGVtLmNsYXNzTGlzdC5jb250YWlucyhfY2xhc3MpKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vZGVMaXN0Q29udGFpbnNFbGVtZW50KF9ub2RlTGlzdCwgX2VsZW0pIHtcbiAgZm9yIChjb25zdCBsaXN0RWxlbSBvZiBfbm9kZUxpc3QpIHtcbiAgICBpZiAobGlzdEVsZW0gPT09IF9lbGVtKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRDb250YWluc0VsZW1lbnQoX2VsZW0xLCBfZWxlbTIpIHtcbiAgY29uc3QgY29udGVudHMgPSBfZWxlbTEucXVlcnlTZWxlY3RvckFsbChcIipcIik7XG5cbiAgZm9yIChjb25zdCBlbGVtVG9DaGVjayBvZiBjb250ZW50cykge1xuICAgIGlmIChlbGVtVG9DaGVjayA9PT0gX2VsZW0yKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRJc09yQ29udGFpbnNFbGVtZW50KF9lbGVtMSwgX2VsZW0yKSB7XG4gIGlmIChfZWxlbTEgPT09IF9lbGVtMikgcmV0dXJuIHRydWU7XG4gIHJldHVybiBlbGVtZW50Q29udGFpbnNFbGVtZW50KF9lbGVtMSwgX2VsZW0yKTtcbn1cbiIsImltcG9ydCB7XG4gIGNyZWF0ZVN2ZyxcbiAgZWxlbWVudElzT3JDb250YWluc0VsZW1lbnQsXG4gIG5vZGVMaXN0Q29udGFpbnNDbGFzcyxcbiAgbm9kZUxpc3RDb250YWluc0VsZW1lbnQsXG59IGZyb20gXCIuL2RvbS11dGlsaXRpZXMuanNcIjtcblxuY29uc3QgZGVmYXVsdEhvdmVyRGVsYXkgPSA1MDA7XG5cbmNsYXNzIERyb3Bkb3duQmFyIHtcbiAgZHJvcGRvd25zID0gW107XG4gIGh0bWxCYXI7XG5cbiAgLy8gX2h0bWxCYXIgaXMgYSA8ZGl2IGNsYXNzPVwiZHJvcGRvd24tYmFyXCI+IGNvbnRhaW5pbmcgYXQgbGVhc3Qgb25lIGJ1dHRvbiBvclxuICAvLyBkaXYgb2YgY2xhc3MgXCJkcm9wZG93bi1hbmNob3JcIi5cbiAgY29uc3RydWN0b3IoX2h0bWxCYXIpIHtcbiAgICB0aGlzLmh0bWxCYXIgPSBfaHRtbEJhcjtcbiAgICBjb25zdCBodG1sTWVudXMgPSBfaHRtbEJhci5xdWVyeVNlbGVjdG9yQWxsKFwiLmRyb3Bkb3duLWFuY2hvclwiKTtcblxuICAgIGh0bWxNZW51cy5mb3JFYWNoKChfZWxlbSkgPT4ge1xuICAgICAgdGhpcy5kcm9wZG93bnMucHVzaChuZXcgRHJvcGRvd24oX2VsZW0pKTtcbiAgICB9KTtcblxuICAgIHRoaXMuYXR0YWNoTW91c2VFbnRlckxpc3RlbmVycygpO1xuICB9XG5cbiAgYXR0YWNoTW91c2VFbnRlckxpc3RlbmVycygpIHtcbiAgICB0aGlzLmRyb3Bkb3ducy5mb3JFYWNoKChfZHJvcGRvd24pID0+IHtcbiAgICAgIHRoaXMuYXR0YWNoTW91c2VFbnRlckxpc3RlbmVyKF9kcm9wZG93bik7XG4gICAgfSk7XG4gIH1cblxuICBhdHRhY2hNb3VzZUVudGVyTGlzdGVuZXIoX2Ryb3Bkb3duKSB7XG4gICAgY29uc3QgYW5jaG9yID0gX2Ryb3Bkb3duLmdldEFuY2hvcigpO1xuXG4gICAgYW5jaG9yLmh0bWxFbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsICgpID0+IHtcbiAgICAgIHRoaXMuc3dpdGNoT3BlbmVkRHJvcGRvd25zKF9kcm9wZG93bik7XG4gICAgfSk7XG4gIH1cblxuICBzd2l0Y2hPcGVuZWREcm9wZG93bnMoX3RhcmdldERyb3Bkb3duKSB7XG4gICAgY29uc3QgdGFyZ2V0QW5jaG9yID0gX3RhcmdldERyb3Bkb3duLmdldEFuY2hvcigpO1xuXG4gICAgaWYgKHRhcmdldEFuY2hvci5pc0VuYWJsZWQoKSkge1xuICAgICAgY29uc3QgbmVlZE1lbnVPcGVuID0gdGhpcy5jbG9zZU9wZW5lZERyb3Bkb3ducyhbX3RhcmdldERyb3Bkb3duXSk7XG5cbiAgICAgIGlmIChuZWVkTWVudU9wZW4pIHtcbiAgICAgICAgdGFyZ2V0QW5jaG9yLm9wZW5Ecm9wZG93bigpO1xuICAgICAgICB0YXJnZXRBbmNob3IuaHRtbEVsZW0uY2xhc3NMaXN0LmFkZChcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNsb3NlT3BlbmVkRHJvcGRvd25zKF9rZWVwT3Blbikge1xuICAgIGxldCBudW1DbG9zZWQgPSAwO1xuXG4gICAgdGhpcy5kcm9wZG93bnMuZm9yRWFjaCgoX21lbnUpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgIV9rZWVwT3Blbi5pbmNsdWRlcyhfbWVudSkgJiZcbiAgICAgICAgX21lbnUuZ2V0QW5jaG9yKCkuaHRtbEVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwib3BlbmVkXCIpXG4gICAgICApIHtcbiAgICAgICAgbnVtQ2xvc2VkKys7XG4gICAgICAgIF9tZW51LmNsb3NlSGllcmFyY2h5KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbnVtQ2xvc2VkO1xuICB9XG59XG5cbmNsYXNzIERyb3Bkb3duIHtcbiAgb3JpZ2lucyA9IFtdO1xuICBob3ZlckRlbGF5O1xuICBodG1sQW5jaG9yO1xuXG4gIC8vIF9odG1sRHJvcGRvd25BbmNob3IgaXMgYSA8ZGl2IGNsYXNzPVwiZHJvcGRvd24tYW5jaG9yXCI+IG9yXG4gIC8vIDxidXR0b24gY2xhc3M9XCJkcm9wZG93bi1hbmNob3JcIj4gdGhhdCBjb250YWlucyBhdCBsZWFzdCBvbmUgPGRpdj4gd2l0aCBtZW51XG4gIC8vIGl0ZW0gZGF0YS5cbiAgY29uc3RydWN0b3IoX2h0bWxEcm9wZG93bkFuY2hvcikge1xuICAgIHRoaXMuaHRtbEFuY2hvciA9IF9odG1sRHJvcGRvd25BbmNob3I7XG4gICAgdGhpcy5ob3ZlckRlbGF5ID1cbiAgICAgIF9odG1sRHJvcGRvd25BbmNob3IuZ2V0QXR0cmlidXRlKFwiaG92ZXJkZWxheVwiKSB8fCBkZWZhdWx0SG92ZXJEZWxheTtcblxuICAgIC8vIFRoZSBkcm9wZG93bidzIGFuY2hvciBpcyBhbHdheXMgYXQgdGhpcy5vcmlnaW5zWzBdLlxuICAgIHRoaXMub3JpZ2lucy5wdXNoKG5ldyBEcm9wZG93bk9yaWdpbihfaHRtbERyb3Bkb3duQW5jaG9yLCB0aGlzLmhvdmVyRGVsYXkpKTtcbiAgICBjb25zdCBzdWJvcmlnaW5zID0gX2h0bWxEcm9wZG93bkFuY2hvci5xdWVyeVNlbGVjdG9yQWxsKFwiLmRyb3Bkb3duLWV4cGFuZFwiKTtcblxuICAgIGZvciAoY29uc3Qgb3JpZ2luIG9mIHN1Ym9yaWdpbnMpIHtcbiAgICAgIHRoaXMub3JpZ2lucy5wdXNoKG5ldyBEcm9wZG93bk9yaWdpbihvcmlnaW4sIHRoaXMuaG92ZXJEZWxheSkpO1xuICAgIH1cblxuICAgIHRoaXMuYXR0YWNoTW91c2VFbnRlckxpc3RlbmVyKCk7XG4gICAgdGhpcy5hdHRhY2hDbGlja0xpc3RlbmVyKCk7XG4gICAgdGhpcy5hdHRhY2hSZXNpemVMaXN0ZW5lcigpO1xuICAgIHRoaXMuYXR0YWNoQ2xvc2VPblNlbGVjdExpc3RlbmVycygpO1xuICB9XG5cbiAgZ2V0QW5jaG9yKCkge1xuICAgIHJldHVybiB0aGlzLm9yaWdpbnNbMF07XG4gIH1cblxuICBjbG9zZUhpZXJhcmNoeSgpIHtcbiAgICB0aGlzLm9yaWdpbnMuZm9yRWFjaCgoX29yaWdpbikgPT4ge1xuICAgICAgX29yaWdpbi5odG1sRWxlbS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICBfb3JpZ2luLmh0bWxFbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuZWRcIik7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZURlZXBlclRoYW5Nb3VzZShfbW91c2VYLCBfbW91c2VZLCBfaW1tZWRpYXRlKSB7XG4gICAgY29uc3QgdW5kZXJNb3VzZSA9IGRvY3VtZW50LmVsZW1lbnRzRnJvbVBvaW50KF9tb3VzZVgsIF9tb3VzZVkpO1xuICAgIGxldCBtZW51VW5kZXJNb3VzZTtcblxuICAgIC8vIEZpbmQgdGhlIGFjdHVhbCBIVE1MIGVsZW1lbnQgZm9yIHRoaXMgZHJvcGRvd24uIENhbid0IGp1c3QgdXNlXG4gICAgLy8gX2V2ZW50LnRhcmdldCBiZWNhdXNlIHRoYXQgZ2l2ZXMgdXMgdGhlIGFuY2hvciBlbGVtZW50LCBub3QgdGhlXG4gICAgLy8gc3VibWVudSBlbGVtZW50LlxuICAgIGZvciAoY29uc3QgZWxlbSBvZiB1bmRlck1vdXNlKSB7XG4gICAgICBpZiAoZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJkcm9wZG93blwiKSkge1xuICAgICAgICBtZW51VW5kZXJNb3VzZSA9IGVsZW07XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghbWVudVVuZGVyTW91c2UpIHJldHVybjtcblxuICAgIGNvbnN0IHN1Ym1lbnVzID0gbWVudVVuZGVyTW91c2UucXVlcnlTZWxlY3RvckFsbChcbiAgICAgIFwiLmRyb3Bkb3duLWV4cGFuZCwgLmRyb3Bkb3duLWFuY2hvclwiXG4gICAgKTtcblxuICAgIC8vIFVuaGlnaGxpZ2h0L2Nsb3NlIGFueSBtZW51cyBkZWVwZXIgdGhhbiB0aGUgbWVudSB0aGUgbW91c2UgbW92ZWQgaW50by5cbiAgICBmb3IgKGNvbnN0IHN1Ym1lbnUgb2Ygc3VibWVudXMpIHtcbiAgICAgIGlmIChfaW1tZWRpYXRlKSB7XG4gICAgICAgIGlmICghc3VibWVudS5jbGFzc0xpc3QuY29udGFpbnMoXCJoaWdobGlnaHRlZFwiKSkge1xuICAgICAgICAgIHN1Ym1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5lZFwiKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3VibWVudS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgIHN1Ym1lbnUubWVudUNsb3NlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmICghc3VibWVudS5jbGFzc0xpc3QuY29udGFpbnMoXCJoaWdobGlnaHRlZFwiKSkge1xuICAgICAgICAgICAgc3VibWVudS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlbmVkXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcy5ob3ZlckRlbGF5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBMaXN0ZW4gZm9yIGNsaWNrcyBvdXRzaWRlIG9mIHRoZSBtZW51IGhpZXJhcmNoeSBhbmQgY2xvc2UgdGhlIGVudGlyZVxuICAvLyBoaWVyYXJjaHkgaWYgb25lIG9jY3Vycy5cbiAgY2xvc2VPbkNsaWNrT3V0c2lkZUhpZXJhcmNoeShfY2xpY2tUYXJnZXQpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLmh0bWxBbmNob3IuY2xhc3NMaXN0LmNvbnRhaW5zKFwib3BlbmVkXCIpICYmXG4gICAgICAhZWxlbWVudElzT3JDb250YWluc0VsZW1lbnQodGhpcy5odG1sQW5jaG9yLCBfY2xpY2tUYXJnZXQpXG4gICAgKSB7XG4gICAgICB0aGlzLmNsb3NlSGllcmFyY2h5KCk7XG4gICAgfVxuICB9XG5cbiAgcmVwb3NpdGlvbk9mZnNjcmVlbkRyb3Bkb3ducygpIHtcbiAgICBpZiAodGhpcy5nZXRBbmNob3IoKS5odG1sRWxlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuZWRcIikpIHtcbiAgICAgIHRoaXMuZ2V0QW5jaG9yKCkucmVwb3NpdGlvbk9mZnNjcmVlbk1lbnUoKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0aGlzLm9yaWdpbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMub3JpZ2luc1tpXS5odG1sRWxlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuZWRcIikpIHtcbiAgICAgICAgICB0aGlzLm9yaWdpbnNbaV0ucmVwb3NpdGlvbk9mZnNjcmVlbk1lbnUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGF0dGFjaE1vdXNlRW50ZXJMaXN0ZW5lcigpIHtcbiAgICB0aGlzLmh0bWxBbmNob3IuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKF9ldmVudCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZURlZXBlclRoYW5Nb3VzZShfZXZlbnQuY2xpZW50WCwgX2V2ZW50LmNsaWVudFksIGZhbHNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGF0dGFjaENsaWNrTGlzdGVuZXIoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoX2V2ZW50KSA9PiB7XG4gICAgICB0aGlzLmNsb3NlT25DbGlja091dHNpZGVIaWVyYXJjaHkoX2V2ZW50LnRhcmdldCk7XG4gICAgICB0aGlzLmNsb3NlRGVlcGVyVGhhbk1vdXNlKF9ldmVudC5jbGllbnRYLCBfZXZlbnQuY2xpZW50WSwgdHJ1ZSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBXZSBhdHRhY2ggdGhlIHJlc2l6ZSBsaXN0ZW5lciB0byBEcm9wZG93biBpbnN0ZWFkIG9mIGluZGl2aWR1YWxcbiAgLy8gRHJvcGRvd25PcmlnaW5zIHRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIGNoZWNrcyBtYWRlIG9uIHJlc2l6ZSBieSBjbG9zZWRcbiAgLy8gbWVudXMuXG4gIGF0dGFjaFJlc2l6ZUxpc3RlbmVyKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJyZXNpemVcIixcbiAgICAgIHRoaXMucmVwb3NpdGlvbk9mZnNjcmVlbkRyb3Bkb3ducy5iaW5kKHRoaXMpXG4gICAgKTtcbiAgfVxuXG4gIGF0dGFjaENsb3NlT25TZWxlY3RMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgaXRlbURpdnMgPSB0aGlzLmh0bWxBbmNob3IucXVlcnlTZWxlY3RvckFsbChcbiAgICAgIFwiLmRyb3Bkb3duID4gZGl2ID4gZGl2OmZpcnN0LW9mLXR5cGVcIlxuICAgICk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbURpdnMpIHtcbiAgICAgIGlmIChcbiAgICAgICAgaXRlbS5nZXRBdHRyaWJ1dGUoXCJjbG9zZW9uc2VsZWN0XCIpID09PSBcInRydWVcIiAmJlxuICAgICAgICBpdGVtLmdldEF0dHJpYnV0ZShcImVuYWJsZWRcIikgIT09IFwiZmFsc2VcIlxuICAgICAgKSB7XG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoX2V2ZW50KSA9PiB7XG4gICAgICAgICAgaWYgKF9ldmVudC5idXR0b24gPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VIaWVyYXJjaHkoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jbGFzcyBEcm9wZG93bk9yaWdpbiB7XG4gIGVudGVyVGltZTtcbiAgaHRtbEVsZW07XG4gIG1lbnVFbGVtO1xuICBpdGVtRWxlbTtcbiAgbWVudUl0ZW1PdXRlckRpdnM7XG4gIG1lbnVJdGVtQ29udGVudERpdnMgPSBbXTtcbiAgbWVudU9wZW5UaW1lb3V0O1xuICBtZW51Q2xvc2VUaW1lb3V0O1xuICBob3ZlckRlbGF5O1xuICBwb3BEaXJlY3Rpb247XG4gIGFwcGVhckFuaW1SdW5uaW5nID0gZmFsc2U7XG4gIGlzQW5jaG9yO1xuXG4gIHN0YXRpYyBwb3NpdGlvbk9mZnNldFZhbHVlcyA9IHtcbiAgICBuZWdhdGl2ZUFuY2hvckhvcml6Qm9yZGVyT2Zmc2V0OlxuICAgICAgXCJjYWxjKHZhcigtLWRyb3Bkb3duLWFuY2hvci1ib3JkZXItd2lkdGgtaG9yaXopICogLTEpXCIsXG4gICAgbmVnYXRpdmVBbmNob3JWZXJ0Qm9yZGVyT2Zmc2V0OlxuICAgICAgXCJjYWxjKHZhcigtLWRyb3Bkb3duLWFuY2hvci1ib3JkZXItd2lkdGgtdmVydCkgKiAtMSlcIixcbiAgICBuZWdhdGl2ZUJvcmRlck9mZnNldDogXCJjYWxjKHZhcigtLWRyb3Bkb3duLWJvcmRlci13aWR0aCkgKiAtMSlcIixcbiAgICBmdWxsT2Zmc2V0OiBcIjEwMCVcIixcbiAgfTtcblxuICBzdGF0aWMgaW52ZXJ0ZWREaXJlY3Rpb25zID0ge1xuICAgIHRvcDogXCJib3R0b21cIixcbiAgICBib3R0b206IFwidG9wXCIsXG4gICAgcmlnaHQ6IFwibGVmdFwiLFxuICAgIGxlZnQ6IFwicmlnaHRcIixcbiAgfTtcblxuICBjb25zdHJ1Y3RvcihfaHRtbEVsZW0sIF9ob3ZlckRlbGF5KSB7XG4gICAgdGhpcy5odG1sRWxlbSA9IF9odG1sRWxlbTtcbiAgICB0aGlzLm1lbnVFbGVtID0gX2h0bWxFbGVtLnF1ZXJ5U2VsZWN0b3IoXCIuZHJvcGRvd25cIik7XG4gICAgdGhpcy5tZW51SXRlbU91dGVyRGl2cyA9IHRoaXMuZ2V0QWxsTWVudUl0ZW1zQXRUaGlzRHJvcGRvd25MZXZlbCgpO1xuICAgIHRoaXMuaXNBbmNob3IgPSB0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5jb250YWlucyhcImRyb3Bkb3duLWFuY2hvclwiKTtcbiAgICBsZXQgcG9wRGlyO1xuXG4gICAgaWYgKCF0aGlzLmlzQW5jaG9yKSB7XG4gICAgICBwb3BEaXIgPSBfaHRtbEVsZW0uZ2V0QXR0cmlidXRlKFwicG9wZGlyZWN0aW9uXCIpIHx8IFwicmlnaHQtYm90dG9tXCI7XG4gICAgICB0aGlzLmFwcGVuZFN1Ym1lbnVBcnJvdygpO1xuICAgICAgdGhpcy5pdGVtRWxlbSA9IF9odG1sRWxlbS5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBcIi5kcm9wZG93biA+IGRpdiA+IGRpdjpmaXJzdC1vZi10eXBlXCJcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvcERpciA9IF9odG1sRWxlbS5nZXRBdHRyaWJ1dGUoXCJwb3BkaXJlY3Rpb25cIikgfHwgXCJib3R0b20tcmlnaHRcIjtcbiAgICAgIHRoaXMuaXRlbUVsZW0gPSBfaHRtbEVsZW0ucXVlcnlTZWxlY3RvcihcbiAgICAgICAgXCIuZHJvcGRvd24tYW5jaG9yID4gZGl2OmZpcnN0LW9mLXR5cGVcIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLnBvcERpcmVjdGlvbiA9IHBvcERpci5zcGxpdChcIi1cIik7XG4gICAgdGhpcy5ob3ZlckRlbGF5ID0gX2hvdmVyRGVsYXkgfHwgZGVmYXVsdEhvdmVyRGVsYXk7XG5cbiAgICBsZXQgb3Blbk9uSG92ZXIgPSBfaHRtbEVsZW0uZ2V0QXR0cmlidXRlKFwib25zZXRcIik7XG5cbiAgICBpZiAoIW9wZW5PbkhvdmVyKSB7XG4gICAgICBvcGVuT25Ib3ZlciA9IHRoaXMuaXNBbmNob3IgPyBcImZhbHNlXCIgOiBcInRydWVcIjtcbiAgICB9XG5cbiAgICB0aGlzLmF0dGFjaE1vdXNlRW50ZXJMaXN0ZW5lcihvcGVuT25Ib3ZlciA9PT0gXCJ0cnVlXCIpO1xuICAgIHRoaXMuYXR0YWNoQ2xpY2tMaXN0ZW5lcigpO1xuICAgIHRoaXMuYXR0YWNoTW91c2VMZWF2ZUxpc3RlbmVycygpO1xuICAgIHRoaXMuYXR0YWNoQW5pbUxpc3RlbmVycygpO1xuICB9XG5cbiAgZ2V0QWxsTWVudUl0ZW1zQXRUaGlzRHJvcGRvd25MZXZlbCgpIHtcbiAgICBjb25zdCBkaXZzID0gW3RoaXMubWVudUVsZW0ucXVlcnlTZWxlY3RvcihcIi5kcm9wZG93biA+IGRpdlwiKV07XG4gICAgbGV0IG5leHREaXYgPSBkaXZzWzBdLm5leHRTaWJsaW5nO1xuXG4gICAgd2hpbGUgKG5leHREaXYpIHtcbiAgICAgIGlmIChcbiAgICAgICAgbmV4dERpdi5ub2RlVHlwZSA9PT0gMSAmJlxuICAgICAgICAhbmV4dERpdi5jbGFzc0xpc3QuY29udGFpbnMoXCJkcm9wZG93bi1zcGFjZXJcIilcbiAgICAgICkge1xuICAgICAgICBkaXZzLnB1c2gobmV4dERpdik7XG4gICAgICB9XG5cbiAgICAgIG5leHREaXYgPSBuZXh0RGl2Lm5leHRTaWJsaW5nO1xuICAgIH1cblxuICAgIHJldHVybiBkaXZzO1xuICB9XG5cbiAgYXBwZW5kU3VibWVudUFycm93KCkge1xuICAgIGNvbnN0IG1lbnUgPSB0aGlzLmh0bWxFbGVtLnF1ZXJ5U2VsZWN0b3IoXCIuZHJvcGRvd25cIik7XG4gICAgaWYgKCFtZW51KSByZXR1cm47XG5cbiAgICBjb25zdCBzdmcgPSBjcmVhdGVTdmcoXCJNMTAsMTdMMTUsMTJMMTAsN1YxN1pcIik7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoXCJkcm9wZG93bi1leHBhbmQtaW1nXCIpO1xuICAgIHRoaXMuaHRtbEVsZW0uaW5zZXJ0QmVmb3JlKHN2ZywgbWVudSk7XG4gIH1cblxuICBzZXRNZW51VG9EZWZhdWx0UG9zaXRpb24oKSB7XG4gICAgbGV0IHNlY29uZE9mZnNldDtcblxuICAgIC8vIE9mZnNldCBpbiB0aGUgZmlyc3QgZGlyZWN0aW9uIGRvZXMgbm90IGNvcnJlY3QgZm9yIGJvcmRlciB3aWR0aDsgb2Zmc2V0XG4gICAgLy8gaW4gdGhlIHNlY29uZCBkaXJlY3Rpb24gZG9lcy4gQW4gYW5jaG9yIG1heSBoYXZlIHNlcGFyYXRlIGhvcml6b250YWwgYW5kXG4gICAgLy8gdmVydGljYWwgYm9yZGVyIHdpZHRocy5cbiAgICBpZiAodGhpcy5pc0FuY2hvcikge1xuICAgICAgaWYgKHRoaXMucG9wRGlyZWN0aW9uWzFdID09PSBcInJpZ2h0XCIgfHwgdGhpcy5wb3BEaXJlY3Rpb25bMV0gPT09IFwibGVmdFwiKSB7XG4gICAgICAgIHNlY29uZE9mZnNldCA9XG4gICAgICAgICAgRHJvcGRvd25PcmlnaW4ucG9zaXRpb25PZmZzZXRWYWx1ZXMubmVnYXRpdmVBbmNob3JIb3JpekJvcmRlck9mZnNldDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlY29uZE9mZnNldCA9XG4gICAgICAgICAgRHJvcGRvd25PcmlnaW4ucG9zaXRpb25PZmZzZXRWYWx1ZXMubmVnYXRpdmVBbmNob3JWZXJ0Qm9yZGVyT2Zmc2V0O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWNvbmRPZmZzZXQgPSBEcm9wZG93bk9yaWdpbi5wb3NpdGlvbk9mZnNldFZhbHVlcy5uZWdhdGl2ZUJvcmRlck9mZnNldDtcbiAgICB9XG5cbiAgICBjb25zdCBpbnZEaXIgPSBbXG4gICAgICBEcm9wZG93bk9yaWdpbi5pbnZlcnRlZERpcmVjdGlvbnNbdGhpcy5wb3BEaXJlY3Rpb25bMF1dLFxuICAgICAgRHJvcGRvd25PcmlnaW4uaW52ZXJ0ZWREaXJlY3Rpb25zW3RoaXMucG9wRGlyZWN0aW9uWzFdXSxcbiAgICBdO1xuXG4gICAgdGhpcy5tZW51RWxlbS5zdHlsZVt0aGlzLnBvcERpcmVjdGlvblswXV0gPSBcIlwiO1xuICAgIHRoaXMubWVudUVsZW0uc3R5bGVbaW52RGlyWzBdXSA9XG4gICAgICBEcm9wZG93bk9yaWdpbi5wb3NpdGlvbk9mZnNldFZhbHVlcy5mdWxsT2Zmc2V0O1xuICAgIHRoaXMubWVudUVsZW0uc3R5bGVbdGhpcy5wb3BEaXJlY3Rpb25bMV1dID0gXCJcIjtcbiAgICB0aGlzLm1lbnVFbGVtLnN0eWxlW2ludkRpclsxXV0gPSBzZWNvbmRPZmZzZXQ7XG4gICAgdGhpcy5tZW51RWxlbS5zdHlsZVtcInRyYW5zZm9ybS1vcmlnaW5cIl0gPSBgJHtpbnZEaXJbMF19ICR7aW52RGlyWzFdfWA7XG4gIH1cblxuICByZXBvc2l0aW9uT2Zmc2NyZWVuTWVudSgpIHtcbiAgICBjb25zdCBzY3JlZW5FZGdlTWFyZ2luID0gNTtcbiAgICB0aGlzLnNldE1lbnVUb0RlZmF1bHRQb3NpdGlvbigpO1xuXG4gICAgY29uc3QgdncgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgd2luZG93LmlubmVyV2lkdGg7XG4gICAgY29uc3QgdmggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICBjb25zdCByZWN0ID0gdGhpcy5tZW51RWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBsZWZ0U3RyID0gd2luZG93XG4gICAgICAuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm1lbnVFbGVtKVxuICAgICAgLmdldFByb3BlcnR5VmFsdWUoXCJsZWZ0XCIpO1xuICAgIGNvbnN0IGxlZnROdW0gPSBOdW1iZXIobGVmdFN0ci5yZXBsYWNlKFwicHhcIiwgXCJcIikpO1xuICAgIGNvbnN0IHRvcFN0ciA9IHdpbmRvd1xuICAgICAgLmdldENvbXB1dGVkU3R5bGUodGhpcy5tZW51RWxlbSlcbiAgICAgIC5nZXRQcm9wZXJ0eVZhbHVlKFwidG9wXCIpO1xuICAgIGNvbnN0IHRvcE51bSA9IE51bWJlcih0b3BTdHIucmVwbGFjZShcInB4XCIsIFwiXCIpKTtcblxuICAgIGlmIChyZWN0LmxlZnQgPD0gc2NyZWVuRWRnZU1hcmdpbikge1xuICAgICAgdGhpcy5tZW51RWxlbS5zdHlsZS5sZWZ0ID0gYCR7bGVmdE51bSAtIHJlY3QubGVmdCArIHNjcmVlbkVkZ2VNYXJnaW59cHhgO1xuICAgIH0gZWxzZSBpZiAocmVjdC5yaWdodCA+PSB2dyAtIHNjcmVlbkVkZ2VNYXJnaW4pIHtcbiAgICAgIHRoaXMubWVudUVsZW0uc3R5bGUubGVmdCA9IGAke2xlZnROdW0gLSAocmVjdC5yaWdodCAtIHZ3ICsgc2NyZWVuRWRnZU1hcmdpbil9cHhgO1xuICAgIH1cblxuICAgIGlmIChyZWN0LnRvcCA8PSBzY3JlZW5FZGdlTWFyZ2luKSB7XG4gICAgICB0aGlzLm1lbnVFbGVtLnN0eWxlLnRvcCA9IGAke3RvcE51bSAtIHJlY3QudG9wICsgc2NyZWVuRWRnZU1hcmdpbn1weGA7XG4gICAgfSBlbHNlIGlmIChyZWN0LmJvdHRvbSA+PSB2aCAtIHNjcmVlbkVkZ2VNYXJnaW4pIHtcbiAgICAgIHRoaXMubWVudUVsZW0uc3R5bGUudG9wID0gYCR7dG9wTnVtIC0gKHJlY3QuYm90dG9tIC0gdmggKyBzY3JlZW5FZGdlTWFyZ2luKX1weGA7XG4gICAgfVxuICB9XG5cbiAgaXNFbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1FbGVtLmdldEF0dHJpYnV0ZShcImVuYWJsZWRcIikgIT09IFwiZmFsc2VcIjtcbiAgfVxuXG4gIG9wZW5Ecm9wZG93bigpIHtcbiAgICB0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5hZGQoXCJvcGVuZWRcIik7XG4gICAgdGhpcy5yZXBvc2l0aW9uT2Zmc2NyZWVuTWVudSgpO1xuXG4gICAgdGhpcy5tZW51SXRlbUNvbnRlbnREaXZzLmZvckVhY2goKF9kaXYpID0+IHtcbiAgICAgIF9kaXYuY2xhc3NMaXN0LnJlbW92ZShcIm1vdXNlb3ZlclwiKTtcbiAgICB9KTtcblxuICAgIHRoaXMuaXRlbUVsZW0uY2xhc3NMaXN0LmFkZChcIm1vdXNlb3ZlclwiKTtcbiAgfVxuXG4gIHNjaGVkdWxlT3Blbk1lbnUoKSB7XG4gICAgaWYgKHRoaXMuaXNFbmFibGVkKCkpIHtcbiAgICAgIHRoaXMuaHRtbEVsZW0uY2xhc3NMaXN0LmFkZChcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgdGhpcy5tZW51T3BlblRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5lZFwiKSkge1xuICAgICAgICAgIHRoaXMub3BlbkRyb3Bkb3duKCk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMubWVudUNsb3NlVGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMuaG92ZXJEZWxheSk7XG4gICAgfVxuICB9XG5cbiAgc2NoZWR1bGVDbG9zZU1lbnUoX21vdXNlWCwgX21vdXNlWSkge1xuICAgIGlmICh0aGlzLmlzRW5hYmxlZCgpKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5tZW51T3BlblRpbWVvdXQpO1xuXG4gICAgICBjb25zdCB1bmRlck1vdXNlID0gZG9jdW1lbnQuZWxlbWVudHNGcm9tUG9pbnQoX21vdXNlWCwgX21vdXNlWSk7XG5cbiAgICAgIGlmIChub2RlTGlzdENvbnRhaW5zQ2xhc3ModW5kZXJNb3VzZSwgXCJkcm9wZG93blwiKSkge1xuICAgICAgICB0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWdobGlnaHRlZFwiKTtcbiAgICAgICAgdGhpcy5tZW51Q2xvc2VUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKCF0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5jb250YWlucyhcImhpZ2hsaWdodGVkXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuZWRcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzLmhvdmVyRGVsYXkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZU9wZW5NZW51KF9tb3VzZVgsIF9tb3VzZVkpIHtcbiAgICBpZiAodGhpcy5pc0VuYWJsZWQoKSkge1xuICAgICAgY29uc3QgdW5kZXJNb3VzZSA9IGRvY3VtZW50LmVsZW1lbnRzRnJvbVBvaW50KF9tb3VzZVgsIF9tb3VzZVkpO1xuXG4gICAgICBpZiAobm9kZUxpc3RDb250YWluc0VsZW1lbnQodW5kZXJNb3VzZSwgdGhpcy5odG1sRWxlbSkpIHtcbiAgICAgICAgaWYgKHRoaXMuaHRtbEVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwib3BlbmVkXCIpKSB7XG4gICAgICAgICAgdGhpcy5odG1sRWxlbS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlbmVkXCIpO1xuXG4gICAgICAgICAgaWYgKHRoaXMuaXNBbmNob3IpIHtcbiAgICAgICAgICAgIHRoaXMuaHRtbEVsZW0uY2xhc3NMaXN0LnJlbW92ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLm1lbnVPcGVuVGltZW91dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5odG1sRWxlbS5jbGFzc0xpc3QuYWRkKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgICAgdGhpcy5vcGVuRHJvcGRvd24oKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5tZW51Q2xvc2VUaW1lb3V0KTtcbiAgICB9XG4gIH1cblxuICBhZGRNb3VzZW92ZXJDbGFzcyhfbWVudUl0ZW0pIHtcbiAgICBpZiAoX21lbnVJdGVtLmdldEF0dHJpYnV0ZShcImVuYWJsZWRcIikgIT09IFwiZmFsc2VcIikge1xuICAgICAgX21lbnVJdGVtLmNsYXNzTGlzdC5hZGQoXCJtb3VzZW92ZXJcIik7XG4gICAgfVxuICB9XG5cbiAgYXR0YWNoTW91c2VFbnRlckxpc3RlbmVyKF9vcGVuT25Ib3Zlcikge1xuICAgIHRoaXMuaHRtbEVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKCkgPT4ge1xuICAgICAgaWYgKF9vcGVuT25Ib3Zlcikge1xuICAgICAgICB0aGlzLnNjaGVkdWxlT3Blbk1lbnUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGF0dGFjaENsaWNrTGlzdGVuZXIoKSB7XG4gICAgdGhpcy5odG1sRWxlbS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChfZXZlbnQpID0+IHtcbiAgICAgIGlmIChfZXZlbnQuYnV0dG9uID09PSAwKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlT3Blbk1lbnUoX2V2ZW50LmNsaWVudFgsIF9ldmVudC5jbGllbnRZKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGF0dGFjaE1vdXNlTGVhdmVMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5odG1sRWxlbS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCAoX2V2ZW50KSA9PiB7XG4gICAgICB0aGlzLnNjaGVkdWxlQ2xvc2VNZW51KF9ldmVudC5jbGllbnRYLCBfZXZlbnQuY2xpZW50WSk7XG5cbiAgICAgIC8vIElmIHdlJ3JlIGhvdmVyaW5nIG92ZXIgYSBob3Zlci10by1vcGVuIGFuY2hvciBhbmQgbW92ZSBhd2F5IGJlZm9yZSBpdFxuICAgICAgLy8gb3BlbnMgdGhlIGRyb3Bkb3duLCByZW1vdmUgdGhlIGhpZ2hsaWdodC5cbiAgICAgIGlmIChcbiAgICAgICAgdGhpcy5odG1sRWxlbS5nZXRBdHRyaWJ1dGUoXCJvbnNldFwiKSAhPT0gXCJjbGlja1wiICYmXG4gICAgICAgICF0aGlzLmh0bWxFbGVtLmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5lZFwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuaHRtbEVsZW0uY2xhc3NMaXN0LnJlbW92ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5tZW51SXRlbU91dGVyRGl2cykge1xuICAgICAgY29uc3QgbWVudUl0ZW0gPSBkaXYucXVlcnlTZWxlY3RvcihcIi5kcm9wZG93biA+IGRpdiA+IGRpdjpmaXJzdC1vZi10eXBlXCIpO1xuICAgICAgdGhpcy5tZW51SXRlbUNvbnRlbnREaXZzLnB1c2gobWVudUl0ZW0pO1xuICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5hZGRNb3VzZW92ZXJDbGFzcyhtZW51SXRlbSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhdHRhY2hBbmltTGlzdGVuZXJzKCkge1xuICAgIHRoaXMubWVudUVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbmVuZFwiLCAoX2V2ZW50KSA9PiB7XG4gICAgICBpZiAoX2V2ZW50LmFuaW1hdGlvbk5hbWUgPT09IFwiZHJvcGRvd24tYXBwZWFyXCIpIHtcbiAgICAgICAgdGhpcy5hcHBlYXJBbmltUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlcG9zaXRpb25PZmZzY3JlZW5NZW51KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLm1lbnVFbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25jYW5jZWxcIiwgKF9ldmVudCkgPT4ge1xuICAgICAgaWYgKF9ldmVudC5hbmltYXRpb25OYW1lID09PSBcImRyb3Bkb3duLWFwcGVhclwiKSB7XG4gICAgICAgIHRoaXMuYXBwZWFyQW5pbVJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMubWVudUVsZW0uYWRkRXZlbnRMaXN0ZW5lcihcImFuaW1hdGlvbnN0YXJ0XCIsIChfZXZlbnQpID0+IHtcbiAgICAgIGlmIChfZXZlbnQuYW5pbWF0aW9uTmFtZSA9PT0gXCJkcm9wZG93bi1hcHBlYXJcIikge1xuICAgICAgICB0aGlzLmFwcGVhckFuaW1SdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy51cGRhdGVNZW51QW5pbVBvc2l0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBJZiB0aGlzIGxhZ3MgdGhlIGFuaW1hdGlvbiwgaW5jcmVhc2UgdGhlIHRpbWVvdXQgaW50ZXJ2YWwuXG4gIHVwZGF0ZU1lbnVBbmltUG9zaXRpb24oKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnJlcG9zaXRpb25PZmZzY3JlZW5NZW51KCk7XG5cbiAgICAgIGlmICh0aGlzLmFwcGVhckFuaW1SdW5uaW5nKSB7XG4gICAgICAgIHRoaXMudXBkYXRlTWVudUFuaW1Qb3NpdGlvbigpO1xuICAgICAgfVxuICAgIH0sIDEpO1xuICB9XG59XG5cbi8vIENhbGxpbmcgdGhpcyBmdW5jdGlvbiBmcm9tIHRoZSBjb2RlIHRoYXQgaW1wb3J0cyBpdCB3aWxsIHJlYWQgdGhlIGRyb3Bkb3duXG4vLyBzdHJ1Y3R1cmVzIGluIHRoZSBIVE1MIGFuZCBjb25zdHJ1Y3QgZnVsbCBkcm9wZG93biBtZW51cyBvdXQgb2YgdGhlbS5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEcm9wZG93bnMoKSB7XG4gIGNvbnN0IGh0bWxNZW51QmFycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZHJvcGRvd24tYmFyXCIpO1xuICBjb25zdCBodG1sTG9uZUFuY2hvcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgIFwiKjpub3QoLmRyb3Bkb3duLWJhcikgPiBkaXYuZHJvcGRvd24tYW5jaG9yLCAqOm5vdCguZHJvcGRvd24tYmFyKSA+IGJ1dHRvbi5kcm9wZG93bi1hbmNob3JcIlxuICApO1xuXG4gIGNvbnN0IGJhcnMgPSBbXTtcbiAgY29uc3QgYW5jaG9ycyA9IFtdO1xuXG4gIGh0bWxNZW51QmFycy5mb3JFYWNoKChfYmFyKSA9PiB7XG4gICAgYmFycy5wdXNoKG5ldyBEcm9wZG93bkJhcihfYmFyKSk7XG4gIH0pO1xuXG4gIGh0bWxMb25lQW5jaG9ycy5mb3JFYWNoKChfYW5jaG9yKSA9PiB7XG4gICAgYW5jaG9ycy5wdXNoKG5ldyBEcm9wZG93bihfYW5jaG9yKSk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgYW5jaG9ycyxcbiAgICBiYXJzLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RHJvcGRvd25JdGVtcyhfc291cmNlKSB7XG4gIGlmICghX3NvdXJjZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmRyb3Bkb3duID4gZGl2ID4gZGl2OmZpcnN0LW9mLXR5cGVcIik7XG4gIH0gZWxzZSBpZiAoX3NvdXJjZSBpbnN0YW5jZW9mIERyb3Bkb3duQmFyKSB7XG4gICAgcmV0dXJuIF9zb3VyY2UuaHRtbEJhci5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgXCIuZHJvcGRvd24gPiBkaXYgPiBkaXY6Zmlyc3Qtb2YtdHlwZVwiXG4gICAgKTtcbiAgfSBlbHNlIGlmIChfc291cmNlIGluc3RhbmNlb2YgRHJvcGRvd24pIHtcbiAgICByZXR1cm4gX3NvdXJjZS5odG1sQW5jaG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICBcIi5kcm9wZG93biA+IGRpdiA+IGRpdjpmaXJzdC1vZi10eXBlXCJcbiAgICApO1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBtZW51IGZyb20gXCIuL29zLWxpa2UtZHJvcGRvd24uanNcIjtcblxubWVudS5jcmVhdGVEcm9wZG93bnMoKTtcblxuY29uc3QgbWVudUl0ZW1zID0gbWVudS5nZXREcm9wZG93bkl0ZW1zKCk7XG5jb25zdCBsb2dUZXh0RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9nLXRleHRcIik7XG5cbm1lbnVJdGVtcy5mb3JFYWNoKChfaXRlbSkgPT4ge1xuICBfaXRlbS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChfZXZlbnQpID0+IHtcbiAgICBpZiAoX2V2ZW50LmJ1dHRvbiA9PT0gMCAmJiBfaXRlbS5nZXRBdHRyaWJ1dGUoXCJlbmFibGVkXCIpICE9PSBcImZhbHNlXCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBDbGlja2VkICR7X2l0ZW0uZ2V0QXR0cmlidXRlKFwiaWRcIil9YCk7XG4gICAgICBsb2dUZXh0RWxlbS50ZXh0Q29udGVudCA9IGBDbGlja2VkICR7X2l0ZW0uZ2V0QXR0cmlidXRlKFwiaWRcIil9YDtcbiAgICB9XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiYWRkQ2xhc3NlcyIsIl9lbGVtIiwiX2NsYXNzZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJEcm9wZG93bkJhciIsImRyb3Bkb3ducyIsImh0bWxCYXIiLCJjb25zdHJ1Y3RvciIsIl9odG1sQmFyIiwidGhpcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwicHVzaCIsIkRyb3Bkb3duIiwiYXR0YWNoTW91c2VFbnRlckxpc3RlbmVycyIsIl9kcm9wZG93biIsImF0dGFjaE1vdXNlRW50ZXJMaXN0ZW5lciIsImdldEFuY2hvciIsImh0bWxFbGVtIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN3aXRjaE9wZW5lZERyb3Bkb3ducyIsIl90YXJnZXREcm9wZG93biIsInRhcmdldEFuY2hvciIsImlzRW5hYmxlZCIsImNsb3NlT3BlbmVkRHJvcGRvd25zIiwib3BlbkRyb3Bkb3duIiwiX2tlZXBPcGVuIiwibnVtQ2xvc2VkIiwiX21lbnUiLCJpbmNsdWRlcyIsImNvbnRhaW5zIiwiY2xvc2VIaWVyYXJjaHkiLCJvcmlnaW5zIiwiaG92ZXJEZWxheSIsImh0bWxBbmNob3IiLCJfaHRtbERyb3Bkb3duQW5jaG9yIiwiZ2V0QXR0cmlidXRlIiwiRHJvcGRvd25PcmlnaW4iLCJzdWJvcmlnaW5zIiwib3JpZ2luIiwiYXR0YWNoQ2xpY2tMaXN0ZW5lciIsImF0dGFjaFJlc2l6ZUxpc3RlbmVyIiwiYXR0YWNoQ2xvc2VPblNlbGVjdExpc3RlbmVycyIsIl9vcmlnaW4iLCJyZW1vdmUiLCJjbG9zZURlZXBlclRoYW5Nb3VzZSIsIl9tb3VzZVgiLCJfbW91c2VZIiwiX2ltbWVkaWF0ZSIsInVuZGVyTW91c2UiLCJkb2N1bWVudCIsImVsZW1lbnRzRnJvbVBvaW50IiwibWVudVVuZGVyTW91c2UiLCJlbGVtIiwic3VibWVudXMiLCJzdWJtZW51IiwibWVudUNsb3NlVGltZW91dCIsInNldFRpbWVvdXQiLCJjbG9zZU9uQ2xpY2tPdXRzaWRlSGllcmFyY2h5IiwiX2NsaWNrVGFyZ2V0IiwiX2VsZW0xIiwiX2VsZW0yIiwiY29udGVudHMiLCJlbGVtVG9DaGVjayIsImVsZW1lbnRDb250YWluc0VsZW1lbnQiLCJyZXBvc2l0aW9uT2Zmc2NyZWVuRHJvcGRvd25zIiwicmVwb3NpdGlvbk9mZnNjcmVlbk1lbnUiLCJpIiwibGVuZ3RoIiwiX2V2ZW50IiwiY2xpZW50WCIsImNsaWVudFkiLCJ0YXJnZXQiLCJ3aW5kb3ciLCJiaW5kIiwiaXRlbURpdnMiLCJpdGVtIiwiYnV0dG9uIiwiZW50ZXJUaW1lIiwibWVudUVsZW0iLCJpdGVtRWxlbSIsIm1lbnVJdGVtT3V0ZXJEaXZzIiwibWVudUl0ZW1Db250ZW50RGl2cyIsIm1lbnVPcGVuVGltZW91dCIsInBvcERpcmVjdGlvbiIsImFwcGVhckFuaW1SdW5uaW5nIiwiaXNBbmNob3IiLCJzdGF0aWMiLCJuZWdhdGl2ZUFuY2hvckhvcml6Qm9yZGVyT2Zmc2V0IiwibmVnYXRpdmVBbmNob3JWZXJ0Qm9yZGVyT2Zmc2V0IiwibmVnYXRpdmVCb3JkZXJPZmZzZXQiLCJmdWxsT2Zmc2V0IiwidG9wIiwiYm90dG9tIiwicmlnaHQiLCJsZWZ0IiwiX2h0bWxFbGVtIiwiX2hvdmVyRGVsYXkiLCJwb3BEaXIiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0QWxsTWVudUl0ZW1zQXRUaGlzRHJvcGRvd25MZXZlbCIsImFwcGVuZFN1Ym1lbnVBcnJvdyIsInNwbGl0Iiwib3Blbk9uSG92ZXIiLCJhdHRhY2hNb3VzZUxlYXZlTGlzdGVuZXJzIiwiYXR0YWNoQW5pbUxpc3RlbmVycyIsImRpdnMiLCJuZXh0RGl2IiwibmV4dFNpYmxpbmciLCJub2RlVHlwZSIsIm1lbnUiLCJzdmciLCJfcGF0aCIsIl90aXRsZSIsIl9wYXRoQ2xhc3NlcyIsImNyZWF0ZUVsZW1lbnROUyIsInNldEF0dHJpYnV0ZSIsInRpdGxlIiwidGV4dENvbnRlbnQiLCJjcmVhdGVTdmciLCJhcHBlbmRDaGlsZCIsInBhdGgiLCJpbnNlcnRCZWZvcmUiLCJzZXRNZW51VG9EZWZhdWx0UG9zaXRpb24iLCJzZWNvbmRPZmZzZXQiLCJwb3NpdGlvbk9mZnNldFZhbHVlcyIsImludkRpciIsImludmVydGVkRGlyZWN0aW9ucyIsInN0eWxlIiwidnciLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImlubmVyV2lkdGgiLCJ2aCIsImNsaWVudEhlaWdodCIsImlubmVySGVpZ2h0IiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnRTdHIiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsImxlZnROdW0iLCJOdW1iZXIiLCJyZXBsYWNlIiwidG9wU3RyIiwidG9wTnVtIiwiX2RpdiIsInNjaGVkdWxlT3Blbk1lbnUiLCJjbGVhclRpbWVvdXQiLCJzY2hlZHVsZUNsb3NlTWVudSIsIl9ub2RlTGlzdCIsIl9jbGFzcyIsIm5vZGVMaXN0Q29udGFpbnNDbGFzcyIsInRvZ2dsZU9wZW5NZW51IiwibGlzdEVsZW0iLCJub2RlTGlzdENvbnRhaW5zRWxlbWVudCIsImFkZE1vdXNlb3ZlckNsYXNzIiwiX21lbnVJdGVtIiwiX29wZW5PbkhvdmVyIiwiZGl2IiwibWVudUl0ZW0iLCJhbmltYXRpb25OYW1lIiwidXBkYXRlTWVudUFuaW1Qb3NpdGlvbiIsImh0bWxNZW51QmFycyIsImh0bWxMb25lQW5jaG9ycyIsImJhcnMiLCJhbmNob3JzIiwiX2JhciIsIl9hbmNob3IiLCJtZW51SXRlbXMiLCJsb2dUZXh0RWxlbSIsIl9pdGVtIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=